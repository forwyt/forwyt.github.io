<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="jasonPHD">
  <!-- Open Graph Data -->
  <meta property="og:title" content="Cocoapods制作framework全解析"/>
  <meta property="og:description" content="Apple/易娱科技" />
  <meta property="og:site_name" content="Developer JasonPhd"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://yoursite.com"/>
  
    <link rel="alternate" href="/atom.xml" title="Developer JasonPhd" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>Developer JasonPhd</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/default-banner-dark.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">Cocoapods制作framework全解析</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/forwyt">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:465379032@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By jasonPHD</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2018-03-19</span>
            <span class="time">18:06:35</span>
          </span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <h1 id="cocoapod制作framework详解以及常见问题"><a href="#cocoapod制作framework详解以及常见问题" class="headerlink" title="cocoapod制作framework详解以及常见问题"></a>cocoapod制作framework详解以及常见问题</h1><hr>
<h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><p>创建名字为TestSDK的framework</p>
<blockquote>
<p>pod lib create TestSDK</p>
</blockquote>
<p>回答下面五个问题:<br>按照需要自行选择 推荐选择demo application <strong><em>YES</em></strong> 这样方便边写demo边进行调试</p>
<blockquote>
<p>What platform do you want to use?? [ iOS / macOS ]</p>
<p>What language do you want to use?? [ Swift / ObjC ]</p>
<p>Would you like to include a demo application with your library? [ Yes / No ]</p>
<p>Which testing frameworks will you use? [ Specta / Kiwi / None ]</p>
<p>Would you like to do view based testing? [ Yes / No ]</p>
<p>What is your class prefix?</p>
</blockquote>
<p>如果顺利的话 这个时候Xcode会自动打开一个项目工程如下图所示</p>
<p><img src="/2018/03/19/Cocoapods制作framework全解析/WX20180319-162552.png" alt="WX20180319-162552"></p>
<p>接下来就是详细描述一下podfile文件(这一个开发之中非常重要而且规则很多的地方</p>
<p><img src="/2018/03/19/Cocoapods制作framework全解析/WX20180319-163133.png" alt="WX20180319-163133"></p>
<p>把podspec文件打开成为一个ruby语言描述的,这样就可以语法高亮方便查看<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new do |s|</div><div class="line">#项目名称</div><div class="line">  s.name             = &apos;TestSDK&apos;</div><div class="line">#项目版本号</div><div class="line">  s.version          = &apos;0.1.0&apos;</div><div class="line">#项目摘要</div><div class="line">  s.summary          = &apos;A short description of TestSDK.&apos;</div><div class="line">#项目简短描述</div><div class="line">  s.description      = &apos;这里填写您的项目描述建议这个要比summary长,听说是有人出错在这里(⊙﹏⊙)b&apos;</div><div class="line">#项目的主页</div><div class="line">  s.homepage         = &apos;https://github.com/XXX/TestSDK&apos;</div><div class="line">#sdk的图片 为了美可以设置, </div><div class="line"># s.screenshots     = &apos;www.example.com/screenshots_1&apos;, &apos;www.example.com/screenshots_2&apos;</div><div class="line">#项目开源的许可证类型</div><div class="line">s.license          = &#123; :type =&gt; &apos;MIT&apos;, :file =&gt; &apos;LICENSE&apos; &#125;</div><div class="line">#项目的作者</div><div class="line">s.author           = &#123; &apos;XXX&apos; =&gt; &apos;XX@qq.com&apos; &#125;</div><div class="line">#源代码</div><div class="line">s.source           = &#123; :git =&gt; &apos;https://github.com/forwyt/TestSDK.git&apos;, :tag =&gt; s.version.to_s &#125;</div><div class="line">#设交媒体</div><div class="line"># s.social_media_url = &apos;https://twitter.com/&lt;TWITTER_USERNAME&gt;&apos;</div><div class="line">---------------------------------------------------------</div><div class="line">#下面比较重要</div><div class="line">#项目的最低支持版本</div><div class="line">  s.ios.deployment_target = &apos;8.0&apos;</div><div class="line">#项目的目录结构(总体上说我们将所有的文件都放在这里)</div><div class="line">  s.source_files = &apos;TestSDK/Classes/**/*&apos;</div><div class="line">#如果你需要用到 图片 或者很少人提到的 xib文件打包之后成为nib都是需要一个bundle指定路径</div><div class="line">  # s.resource_bundles = &#123;</div><div class="line">  #   &apos;TestSDK&apos; =&gt; [&apos;TestSDK/Assets/*.png&apos;]</div><div class="line">  # &#125;</div><div class="line">#公共头文件在这里</div><div class="line">s.public_header_files = &apos;Pod/Classes/**/*.h&apos;</div><div class="line">#如果你项目中自己使用到的系统库需要在这里添加</div><div class="line">  s.frameworks = &apos;UIKit&apos;, &apos;MapKit&apos;</div><div class="line">#依赖的第三方框架需要在这里添加</div><div class="line">  s.dependency &apos;AFNetworking&apos;, &apos;~&gt; 2.3&apos;</div><div class="line">-------------------------------------------------------------</div></pre></td></tr></table></figure></p>
<h2 id="验证以及git相关知识"><a href="#验证以及git相关知识" class="headerlink" title="验证以及git相关知识"></a>验证以及git相关知识</h2><p>当你开发完成之后,你需要在git的服务器上(这里以github说明,建立起你的开源库地址)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add remote xxx</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd 项目层</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git add .</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git commit -m&quot;xxx&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git tag v0.1.0 (这里强烈建议大家一定按照步骤来 因为podspec里面如果是指定了0.1.0那么大家就0.1.0 一句话相互对应即可)</div><div class="line"></div><div class="line">git push </div><div class="line"></div><div class="line">git push tags 需要将tags也都上传到服务器上</div></pre></td></tr></table></figure>
<p>假如一切顺利 这个时候你的 项目源码和tag应该都是子github里面的</p>
<p>最后我们需要验证有没有错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod lib lint xxx.podspec --allow warings(允许有黄色警告)如果不需要刻意不带</div></pre></td></tr></table></figure></p>
<h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><p>一般来说如果你不打算开源项目 sdk开发程序员会将自己的库封装好,头文件暴露出来,并且FQA写好这样就算是一个大体合格的framewoke</p>
<ul>
<li>手动打包<ul>
<li>手动打包的过程是非常机械且繁琐的,不仅你需要给开发人员真机库,还要有模拟器库,所以网上有非常多的教程教你先打第一个真机再打一个模拟器最后合并.这种机械化操作此处不细说</li>
</ul>
</li>
<li>框架打包<ul>
<li>在框架打包之前你需要安装一个库在你的mac</li>
<li><img src="/2018/03/19/Cocoapods制作framework全解析/WX20180319-173836.png" alt="WX20180319-173836"></li>
<li>pod package xxx.podspec –force(这个是强制清空之前打包的库) –a(默认是打包成framework 如果带a就是打包为.a)</li>
</ul>
</li>
</ul>
<h2 id="Bug问题"><a href="#Bug问题" class="headerlink" title="Bug问题"></a>Bug问题</h2><p>然而对于我们开发者来说以上的这是一个基本配置 </p>
<h4 id="1-如果我要设置header或者pch怎么办"><a href="#1-如果我要设置header或者pch怎么办" class="headerlink" title="==1.如果我要设置header或者pch怎么办?=="></a>==1.如果我要设置header或者pch怎么办?==</h4><p>CocoaPods里面,每一次进行打包,制作静态库的时候都会pod install命令<br>如果你写在系统自动生成的XXXX-prefix.pch</p>
<p>pod install之后会消失掉之前你写入的所有文件!! </p>
<p>那么我们假定我们sdk名字叫做WechatSDK,我们就创建一个header名为WechatSDK.h<br>之所以这么写是当别人导入你的framework的时候如果是按照以下格式<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#<span class="keyword">import</span>&lt;WechatSDK/WechatSDK.h&gt;</div></pre></td></tr></table></figure></p>
<p>这样非常的符合初用者的心态而且很专业</p>
<p><img src="/2018/03/19/Cocoapods制作framework全解析/WX20180319-171902.png" alt="WX20180319-171902"></p>
<p>自己定义一个module将里面的umbrella header指向这个自定义的WechatSDK.h,并且在pods- target -buid setting中 packing里 nodulemap未你自定的这个module这样导出的freamework就是非常规范的</p>
<h4 id="2-如果我想将-a-或者-framework-这种静态库直接打包进去那么我又该怎么做"><a href="#2-如果我想将-a-或者-framework-这种静态库直接打包进去那么我又该怎么做" class="headerlink" title="==2.如果我想将.a 或者,framework 这种静态库直接打包进去那么我又该怎么做?=="></a>==2.如果我想将.a 或者,framework 这种静态库直接打包进去那么我又该怎么做?==</h4><p>关于这个问题 可能是报错最多的在sdk开发中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#这两个是我在实际开发中打包微信的.a 和 QQ 的framework</div><div class="line">#首先就需要在podsepc里面指明路径</div><div class="line"> s.ios.vendored_libraries = &apos;Example/Pods/WechatSDK/libWeChatSDK.a&apos;</div><div class="line"> s.ios.vendored_frameworks =&apos;Example/Pods/TencentOpenAPI.framework&apos;</div><div class="line">#其次是需要把微信和QQ所需要的系统库全部写明上去不需要带后缀不然会报错</div><div class="line"> s.frameworks =  &apos;Security&apos;,&apos;SystemConfiguration&apos;,&apos;CoreTelephony&apos;</div><div class="line"> s.libraries  = &apos;z&apos;,&apos;sqlite3.0&apos;,&apos;c++&apos;</div></pre></td></tr></table></figure>
<p>可能会涉及到无法导入头文件,那么你可以在public header 一栏指出即可</p>
<h2 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h2><p>关于发布的详细步骤网上很多 一句最后命令</p>
<p>pod trunk 便可以发布到cocoapods源</p>
<p><img src="/2018/03/19/Cocoapods制作framework全解析/WechatIMG30327.png" alt="WechatIMG30327"></p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p>1.类似的目录图<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line">├── Example</div><div class="line">│   ├── Podfile</div><div class="line">│   ├── Podfile.lock</div><div class="line">│   ├── Pods</div><div class="line">│   │   ├── Headers</div><div class="line">│   │   ├── Local\ Podspecs</div><div class="line">│   │   │   └── Test.podspec.json</div><div class="line">│   │   ├── Manifest.lock</div><div class="line">│   │   ├── Pods.xcodeproj</div><div class="line">│   │   │   ├── project.pbxproj</div><div class="line">│   │   │   └── xcuserdata</div><div class="line">│   │   │       └── jasonphd.xcuserdatad</div><div class="line">│   │   │           └── xcschemes</div><div class="line">│   │   │               ├── Pods-Test_Example.xcscheme</div><div class="line">│   │   │               ├── Pods-Test_Tests.xcscheme</div><div class="line">│   │   │               ├── Test.xcscheme</div><div class="line">│   │   │               └── xcschememanagement.plist</div><div class="line">│   │   └── Target\ Support\ Files</div><div class="line">│   │       ├── Pods-Test_Example</div><div class="line">│   │       │   ├── Info.plist</div><div class="line">│   │       │   ├── Pods-Test_Example-acknowledgements.markdown</div><div class="line">│   │       │   ├── Pods-Test_Example-acknowledgements.plist</div><div class="line">│   │       │   ├── Pods-Test_Example-dummy.m</div><div class="line">│   │       │   ├── Pods-Test_Example-frameworks.sh</div><div class="line">│   │       │   ├── Pods-Test_Example-resources.sh</div><div class="line">│   │       │   ├── Pods-Test_Example-umbrella.h</div><div class="line">│   │       │   ├── Pods-Test_Example.debug.xcconfig</div><div class="line">│   │       │   ├── Pods-Test_Example.modulemap</div><div class="line">│   │       │   └── Pods-Test_Example.release.xcconfig</div><div class="line">│   │       ├── Pods-Test_Tests</div><div class="line">│   │       │   ├── Info.plist</div><div class="line">│   │       │   ├── Pods-Test_Tests-acknowledgements.markdown</div><div class="line">│   │       │   ├── Pods-Test_Tests-acknowledgements.plist</div><div class="line">│   │       │   ├── Pods-Test_Tests-dummy.m</div><div class="line">│   │       │   ├── Pods-Test_Tests-frameworks.sh</div><div class="line">│   │       │   ├── Pods-Test_Tests-resources.sh</div><div class="line">│   │       │   ├── Pods-Test_Tests-umbrella.h</div><div class="line">│   │       │   ├── Pods-Test_Tests.debug.xcconfig</div><div class="line">│   │       │   ├── Pods-Test_Tests.modulemap</div><div class="line">│   │       │   └── Pods-Test_Tests.release.xcconfig</div><div class="line">│   │       └── Test</div><div class="line">│   │           ├── Info.plist</div><div class="line">│   │           ├── Test-dummy.m</div><div class="line">│   │           ├── Test-prefix.pch</div><div class="line">│   │           ├── Test-umbrella.h</div><div class="line">│   │           ├── Test.modulemap</div><div class="line">│   │           └── Test.xcconfig</div><div class="line">│   ├── Test</div><div class="line">│   │   ├── Base.lproj</div><div class="line">│   │   │   ├── LaunchScreen.storyboard</div><div class="line">│   │   │   └── Main.storyboard</div><div class="line">│   │   ├── Images.xcassets</div><div class="line">│   │   │   └── AppIcon.appiconset</div><div class="line">│   │   │       └── Contents.json</div><div class="line">│   │   ├── Test-Info.plist</div><div class="line">│   │   ├── Test-Prefix.pch</div><div class="line">│   │   ├── en.lproj</div><div class="line">│   │   │   └── InfoPlist.strings</div><div class="line">│   │   ├── main.m</div><div class="line">│   │   ├── tAppDelegate.h</div><div class="line">│   │   ├── tAppDelegate.m</div><div class="line">│   │   ├── tViewController.h</div><div class="line">│   │   └── tViewController.m</div><div class="line">│   ├── Test.xcodeproj</div><div class="line">│   │   ├── project.pbxproj</div><div class="line">│   │   ├── project.xcworkspace</div><div class="line">│   │   │   └── contents.xcworkspacedata</div><div class="line">│   │   └── xcshareddata</div><div class="line">│   │       └── xcschemes</div><div class="line">│   │           └── Test-Example.xcscheme</div><div class="line">│   ├── Test.xcworkspace</div><div class="line">│   │   ├── contents.xcworkspacedata</div><div class="line">│   │   └── xcuserdata</div><div class="line">│   │       └── jasonphd.xcuserdatad</div><div class="line">│   │           └── UserInterfaceState.xcuserstate</div><div class="line">│   └── Tests</div><div class="line">│       ├── Tests-Info.plist</div><div class="line">│       ├── Tests-Prefix.pch</div><div class="line">│       ├── Tests.m</div><div class="line">│       └── en.lproj</div><div class="line">│           └── InfoPlist.strings</div><div class="line">├── LICENSE</div><div class="line">├── README.md</div><div class="line">├── Test</div><div class="line">│   ├── Assets</div><div class="line">│   └── Classes</div><div class="line">│       └── ReplaceMe.m</div><div class="line">├── Test.podspec</div><div class="line">└── _Pods.xcodeproj -&gt; Example/Pods/Pods.xcodeproj</div></pre></td></tr></table></figure></p>
<p>2.几个有用的连接</p>
<p><a href="https://github.com/forwyt/EyuFacebook.git" target="_blank" rel="external">这是一个简单的封装Facebook的sdk演示demo sdk</a></p>
<p><a href="https://www.jianshu.com/p/8a7b9232cbab" target="_blank" rel="external">方便大家看流程找了个详细点的流程教学</a></p>
<p><strong><em>总结起来:<br>    我们把不同的功能模块放在不同的文件夹中，通过 podspec 进行配置，通过 podfile 进行引用，通过 pod package 进行打包</em></strong></p>
<p>由于framework上的coding比搭建项目多,可能还有部分以前遇到的问题现在忘记了,如果有什么问题欢迎向我留言提问.我将会全力帮你解答~</p>

        </div>
      </div>
    </div>
  </div>
</article>
<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" style = "width:70%;margin:0 auto"  data-uid="MTAyMC8zMTEwNS83NjU0">
  <script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
  </script>
<noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

